<%- include('../userMainlayouts/mainheader.ejs') %>



<main class="main">
    <div class="page-header text-center" style="background-image: url('user/images/page-header-bg.jpg')">
        <div class="container">
            <h1 class="page-title text-white">Checkout</h1>
        </div><!-- End .container -->
    </div><!-- End .page-header -->
    <nav aria-label="breadcrumb" class="breadcrumb-nav">
        <div class="container">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/">Home</a></li>
                <li class="breadcrumb-item " aria-current="page">Shopping Cart</li>
                <li class="breadcrumb-item active" aria-current="page">Checkout</li>

            </ol>
        </div><!-- End .container -->
    </nav><!-- End .breadcrumb-nav -->

    <div class="page-content ">
        <div class="cart mb-5">
            <div class="container">
                <div class="row">
                    <div class="col-lg-9 cart-item-box">
                        <h5 class="text-dark mb-3">1. &nbsp; Select a delivery address</h5>
                        <div id="selected-address-container">
                            <!-- Selected address content will be displayed here -->
                        </div>
                        <%if(address.address !=0){%>
                            <form action="/checkout3" method="post" id="addressForm">
                                <% for(i=address.address.length-1; i>=0; i--) { %>
                                <label class="p-3 border rounded-4 m-2 custom-label">
                                    <div class="form-check d-flex align-items-center mx-4">
                                        <input class="form-check-input " type="radio" value="<%= address.address[i]._id %>"
                                            name="address" id="Radio<%=address.address[i]._id %>"  <% if(i==address.address.length-1) { %> checked <% } %> 
                                            >
                                            <div class="mx-5">
                                                <p class="text-dark"><b><%= address.address[i].fname %></b>,<%= address.address[i].state %> ,<%= address.address[i].city %>,  
                                                    
                                                            Contanct
                                                            Number:
                                                            <b style="color: #043a6c;">
                                                                <span class="material-symbols-outlined"
                                                                    style="font-size: 13px;"></b><%= address.address[i].mobile %> </p></span>
                                                                    Email:
                                                            <b style="color: #043a6c;">
                                                                <span class="material-symbols-outlined"
                                                                    style="font-size: 13px;"></b><%= address.address[i].email %> </p></span>
                                                            
                                                <p>
                                                    Pincode:<%= address.address[i].pin %>
                                                </p>
                                            </div>
                                    </div>
                                </label>
                                <% } %>
                                
                                <input type="submit" id="submitAddressBtn" style="display: none;">
                            </form>

                        <%}else{%>
                            <div class=" text-center w-100 card">
                                <h6 class="mt-2 ">You have no shipping Address</h6>
                                <p class="">Kindly add a shipping address to proceed.</p>
                                <button type="button" class="btn btn-outline-primary-2 mt-3" data-toggle="modal" data-target="#addAddressModal">
                                    + Add a new address
                                </button>
                            </div>

                       <% }%>
                       <% if(address.address!=0) { %>

                                        
                        <button id="useAddressButton" class="btn btn-outline-primary-2 btn-block py-3"
    style="background-color: #000; color: #fff;" onMouseOver="this.style.background='#575757'"
    onMouseOut="this.style.background='#000'">Use This Address
</button>

                                        <button type="button" class="btn btn-outline-primary-2 mt-3" data-toggle="modal" data-target="#addAddressModal">
                                            + Add a new address
                                        </button>
                        <% }else { %>
                            
                            <button type="button" class="btn btn-outline-primary-2 mt-3" data-toggle="modal" data-target="#addAddressModal">
                                + Add a new address
                            </button>
                                <%}%>
                                            <hr>

                                            <div class=" py-4  mt-2  "
                                                style="border-radius: 10px; background: #F3F3F9;">
                                                <div class="form-check d-flex align-items-center mx-4 ">
                                                    <h5>2. Payment method</h5>
                                                </div>
                                            </div>
                                            <div class=" py-4  mt-1  "
                                                style="border-radius: 10px; background: #F3F3F9;">
                                                <div class="form-check d-flex align-items-center mx-4 ">
                                                    <h5>3. Items and delivery</h5>
                                                </div>
                                            </div>

                    </div><!-- End .col-lg-9 -->
                    <aside class="col-lg-3">
                        <div class="summary summary-cart">
                         

                            <h3 class="summary-title"></h3>

                            <table class="table table-summary">
                                <tbody>

                                    <tr class="summary-subtotal">
                                        <td>Subtotal:</td>
                                        <td>₹<span id="subTotalDisplay">
                                            <%= products.totalPrice %>
                                            </span></td>
                                    </tr><!-- End .summary-subtotal -->




                                    <tr class="summary-shipping-row">
                                        <td>
                                            <label class="" for="standart-shipping">Discount:</label>
                                        </td>
                                        <td>0.00</td>
                                    </tr><!-- End .summary-shipping-row -->





                                    <tr class="summary-total">
                                        <td>Total:</td>
                                        <td>₹<span id="totalDisplay">
                                            <%= products.totalPrice %>
                                            </span></td>
                                    </tr><!-- End .summary-total -->
                                </tbody>
                            </table><!-- End .table table-summary -->

                            <!-- <button class="btn btn-outline-primary-2 btn-order btn-block ">Use This
                                Address</button> -->
                        </div><!-- End .summary -->
                    </aside><!-- End .col-lg-3 -->
                </div><!-- End .row -->
            </div><!-- End .container -->
        </div><!-- End .cart -->
    </div><!-- End .page-content -->
</main><!-- End .main -->

<!-- address adding model  -->



<div class="modal fade" id="addAddressModal" tabindex="-1" aria-labelledby="addAddressModalLabel" aria-hidden="true">
    <!-- Modal: This div represents the modal itself. It has a unique ID and uses Bootstrap's modal classes. -->
    <div class="modal-dialog modal-dialog-centered">
        <!-- Modal Dialog: This div defines the dialog box within the modal. It's centered using Bootstrap's utility classes. -->
        <div class="modal-content">
            <!-- Modal Content: This div contains the content of the modal. It will include the modal's header, body, and footer. -->

            <div class="modal-header">
                <!-- Modal Header: This is the header section of the modal. It typically contains a title and a close button. -->
                <h5 class="modal-title" id="addAddressModalLabel">Add New Address</h5>
                <!-- Title for the modal. -->
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <!-- Close button that dismisses the modal. -->
            </div>

            <div class="modal-body">
                <!-- Modal Body: This is the main content area of the modal. It contains the form for adding a new address. -->
                <form action="/add_address" method="post">
                    <!-- Address input fields go here. You can add more fields as needed. -->
            
                    <form action="/add_address" method="post" id="newAddressForm">
                        <div class="row">
                            <div class="form-group col-sm-6">
                                <label for="fname">First Name</label>
                                <input type="text" class="form-control" id="fname" name="fname" required>
                            </div>
                            <div class="form-group col-sm-6">
                                <label for="lname">Last Name</label>
                                <input type="text" class="form-control" id="lname" name="lname" required>
                            </div>
                            <div class="form-group col-12">
                                <label for="mobile">Mobile</label>
                                <input type="text" class="form-control" id="mobile" name="mobile" required>
                            </div>
                            <div class="form-group col-12">
                                <label for="mobile">Email</label>
                                <input type="text" class="form-control" id="email" name="email" required>
                            </div>
                            <div class="form-group col-12">
                                <label for="housename">House Name</label>
                                <input type="text" class="form-control" id="housename" name="housename" required>
                            </div>
                            <div class="form-group col-12">
                                <label for="city">City</label>
                                <input type="text" class="form-control" id="city" name="city" required>
                            </div>
                            <div class="form-group col-12">
                                <label for="pin">Pin</label>
                                <input type="text" class="form-control" id="pin" name="pin" required>
                            </div>  
                            <div class="form-group col-12">
                                <label for="district">District</label>
                                <input type="text" class="form-control" id="district" name="district" required>
                            </div>
                            <div class="form-group col-12">
                                <label for="state">State</label>
                                <input type="text" class="form-control" id="state" name ="state" required>
                            </div>
                            <!-- Add input fields for other address details here -->
                            <div class="form-group col-12">
                                <button type="submit" class="btn btn-outline-primary-2">
                                    <span>Add Address</span>
                                    <i class="icon-long-arrow-right"></i>
                                </button>
                            </div>
                        </div>
                    </form>
            </div>
            
        </div>
    </div>
</div>




<script>
    // Add a click event listener to the labels
    $(".custom-label").click(function () {
        // Remove the "checked" class from all labels
        $(".custom-label").removeClass("checked");

        // Add the "checked" class to the clicked label
        $(this).addClass("checked");
    });

   
</script>


<script>
    // Add a click event listener to the "Use This Address" button
    document.getElementById("useAddressButton").addEventListener("click", function () {
        // Submit the form with id "addressForm"
        document.getElementById("addressForm").submit();
    });

</script>




<%- include('../userMainlayouts/mainfooter.ejs') %>